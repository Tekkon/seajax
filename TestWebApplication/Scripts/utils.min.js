function SDBrowser_parseUserAgent(e){var t=null,n=null,o=null,r=null,i=/MSIE ([^\s;)]+)/.exec(e),s=/Firefox\/(\S+)/.exec(e),u=/Safari\/(\S+)/.exec(e),S=/Chrome\/(\S+)/.exec(e),c=/Version\/(\S+)/.exec(e),a=/; Trident\/([^\s;)]+)/.exec(e),D=/rv\:([^\s)]+)\) Gecko\//.exec(e),h=/WebKit\/(\S+)/.exec(e);return i?(t=SDBrowser_IE,n=i[1],o=SDBrowser_TRIDENT,a&&(r=a[1])):D?(o=SDBrowser_GECKO,r=D[1],s&&(t=SDBrowser_FF,n=s[1])):h&&(o=SDBrowser_WEBKIT,r=h[1],S?(t=SDBrowser_CHROME,n=S[1]):u&&c&&(t=SDBrowser_SAFARI,n=c[1],r=u[1])),{name:t,version:n,engine:o,engineVersion:r}}function SDPage_getScroll(){var e=new SDPoint,t=document.documentElement||{},n=document.body||{};return"number"==typeof window.pageXOffset?(e.x=pageXOffset,e.y=pageYOffset):n.scrollLeft||n.scrollTop?(e.x=n.scrollLeft,e.y=n.scrollTop):(t.scrollLeft||t.scrollTop)&&(e.x=t.scrollLeft,e.y=t.scrollTop),e}"undefined"==typeof Seadragon2&&(window.Seadragon2={});var SD=Seadragon2,SD_VERSION=SD.VERSION="2.0.pre";SD.toString=function(){return"Seadragon Ajax v"+SD_VERSION+"\nCopyright (c) Microsoft Corp."};var SDPoint=SD.Point=function(e,t){this.x=e||0,this.y=t||0},SDPoint_$=SDPoint.$=function(e){return e instanceof SDPoint?e:(e=e||{},new SDPoint(e.x,e.y))},SDPointPrototype=SDPoint.prototype,SDPoint_origin=new SDPoint(0,0);SDPointPrototype.plus=function(e){return new SDPoint(this.x+e.x,this.y+e.y)},SDPointPrototype.minus=function(e){return new SDPoint(this.x-e.x,this.y-e.y)},SDPointPrototype.times=function(e){return new SDPoint(this.x*e,this.y*e)},SDPointPrototype.divide=function(e){return new SDPoint(this.x/e,this.y/e)},SDPointPrototype.negate=function(){return new SDPoint((-this.x),(-this.y))},SDPointPrototype.apply=function(e){return new SDPoint(e(this.x),e(this.y))},SDPointPrototype.distanceTo=function(e){var t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)},SDPointPrototype.asSize=function(){return new SDSize(this.x,this.y)},SDPointPrototype.equals=function(e){return this.x===(e.x||0)&&this.y===(e.y||0)},SDPointPrototype.toString=function(){return["(",this.x,",",this.y,")"].join("")};var SDSize=SD.Size=function(e,t){this.width=e||0,this.height=t||0},SDSize_$=SDSize.$=function(e){return e instanceof SDSize?e:(e=e||{},new SDSize(e.width,e.height))},SDSizePrototype=SDSize.prototype;SDSizePrototype.plus=function(e){return new SDSize(this.width+e.width,this.height+e.height)},SDSizePrototype.minus=function(e){return new SDSize(this.width-e.width,this.height-e.height)},SDSizePrototype.times=function(e){return new SDSize(this.width*e,this.height*e)},SDSizePrototype.divide=function(e){return new SDSize(this.width/e,this.height/e)},SDSizePrototype.negate=function(){return new SDSize((-this.width),(-this.height))},SDSizePrototype.apply=function(e){return new SDSize(e(this.width),e(this.height))},SDSizePrototype.asPoint=function(){return new SDPoint(this.width,this.height)},SDSizePrototype.equals=function(e){return this.width===(e.width||0)&&this.height===(e.height||0)},SDSizePrototype.toString=function(){return["(",this.width,"x",this.height,")"].join("")};var SDRect=SD.Rect=function(e,t,n,o){e&&void 0===n&&void 0!==e.x&&(n=t.width,o=t.height,t=e.y,e=e.x),this.x=e||0,this.y=t||0,this.width=n||0,this.height=o||0},SDRect_$=SDRect.$=function(e){return e instanceof SDRect?e:new SDRect(e.x,e.y,e.width,e.height)},SDRectPrototype=SDRect.prototype,SDRect_unitRect=new SDRect(0,0,1,1),SDRect_nullRect=new SDRect((-1),(-1),(-1),(-1));SDRectPrototype.getArea=function(){return this.width*this.height},SDRectPrototype.getAspectRatio=function(){return this.width/this.height},SDRectPrototype.getNormHeight=function(){return this.height/this.width},SDRectPrototype.getTopLeft=function(){return new SDPoint(this.x,this.y)},SDRectPrototype.getBottomRight=function(){return new SDPoint(this.x+this.width,this.y+this.height)},SDRectPrototype.getCenter=function(){return new SDPoint(this.x+this.width/2,this.y+this.height/2)},SDRectPrototype.getSize=function(){return new SDSize(this.width,this.height)},SDRectPrototype.contains=function(e){var t=this.x+this.width,n=this.y+this.height,o=e.x+(e.width||0),r=e.y+(e.height||0);return this.x<=e.x&&this.y<=e.y&&t>=o&&n>=r},SDRectPrototype.union=function(e){var t=Math.min(this.x,e.x),n=Math.min(this.y,e.y),o=Math.max(this.x+this.width,e.x+(e.width||0)),r=Math.max(this.y+this.height,e.y+(e.height||0));return new SDRect(t,n,o-t,r-n)},SDRectPrototype.intersect=function(e){var t=Math.max(this.x,e.x),n=Math.max(this.y,e.y),o=-t+Math.min(this.x+this.width,e.x+(e.width||0)),r=-n+Math.min(this.y+this.height,e.y+(e.height||0));return o||r||e instanceof SDRect?o<0||r<0?null:new SDRect(t,n,o,r):new SDPoint(t,n)},SDRectPrototype.scale=function(e,t){var n=t?t.x:this.x,o=t?t.y:this.y;return new SDRect(n-e*(n-this.x),o-e*(o-this.y),this.width*e,this.height*e)},SDRectPrototype.translate=function(e){return new SDRect(this.x+(e.x||0),this.y+(e.y||0),this.width,this.height)},SDRectPrototype.equals=function(e){return this.x===(e.x||0)&&this.y===(e.y||0)&&this.width===(e.width||0)&&this.height===(e.height||0)},SDRectPrototype.toString=function(){return["[",this.x,",",this.y,"|",this.width,"x",this.height,"]"].join("")};var SDString=SD.String={},SDString_format=SDString.format=function(e,t){var n,o;if(2===arguments.length&&t&&t.constructor&&(t.constructor===Array||t.constructor===Object))n=t;else for(n=new Array(arguments.length-1),o=0;o<n.length;o++)n[o]=arguments[o+1];return e.replace(/\{[\d\w]+\}/g,function(e){var t=e.match(/[\d\w]+/);return n[t]||""})},SDDebug=SD.Debug={alert:0,enabled:3},SDDebug_log=SDDebug.log=function(e,t){SDDebug.enabled<3||(arguments.length>1&&(e=SDString_format.apply(this,arguments)),"undefined"!=typeof console&&console.log?console.log(e):SDDebug.alert>=3&&alert(e))},SDDebug_warn=SDDebug.warn=function(e){SDDebug.enabled<2||(arguments.length>1&&(e=SDString_format.apply(this,arguments)),"undefined"!=typeof console&&console.warn?console.warn(e):SDDebug.alert>=2&&alert(e))},SDDebug_error=SDDebug.error=function(e,t){if(!(SDDebug.enabled<1))throw"undefined"!=typeof console&&console.error?console.error(e):SDDebug.alert>=1&&alert(e),t||new Error(e)},SDObject=SD.Object={},SDObject_extend=SDObject.extend=function(e,t,n){for(var o in t)(n||t.hasOwnProperty(o))&&(e[o]=t[o]);return e},SDObject_clone=SDObject.clone=function(e,t){return SDObject_extend({},e,t)},SDFunction=SD.Function={},SDFunction_EMPTY=SDFunction.EMPTY=function(){},SDFunction_bind=SDFunction.bind=function(e,t,n){var o,r=new Array(arguments.length-2),i=r.length;for(o=0;o<i;o++)r[o]=arguments[o+2];return"string"==typeof t&&(t=e[t]),function(){var n,o=arguments.length;for(n=0;n<o;n++)r.push(arguments[n]);t.apply(e,r)}},SDFunction_callback=SDFunction.callback=function(e,t){var n,o=arguments.length,r=new Array(o+1);for(r[0]=null,n=0;n<o;n++)r[n+1]=arguments[n];return SDFunction_bind.apply(SDFunction,r)},SDFunction_delay=SDFunction.delay=function(e,t){return function(){setTimeout(SDFunction_bind(this,e),t)}},SDBrowser=SD.Browser={},SDBrowser_TRIDENT=SDBrowser.TRIDENT="Trident",SDBrowser_GECKO=SDBrowser.GECKO="Gecko",SDBrowser_WEBKIT=SDBrowser.WEBKIT="Webkit",SDBrowser_PRESTO=SDBrowser.PRESTO="Presto",SDBrowser_IE=SDBrowser.IE="IE",SDBrowser_FF=SDBrowser.FIREFOX="Firefox",SDBrowser_SAFARI=SDBrowser.SAFARI="Safari",SDBrowser_CHROME=SDBrowser.CHROME="Chrome",SDBrowser_OPERA=SDBrowser.OPERA="Opera",SDBrowser_isIE,SDBrowser_isFF,SDBrowser_isSafari,SDBrowser_isChrome,SDBrowser_isGecko,SDBrowser_isWebkit,SDBrowser_isOpera;!function(){var e=SDBrowser_parseUserAgent(navigator.userAgent),t=e.name,n=e.version,o=parseInt(n),r=(parseFloat(n),e.engine),i=e.engineVersion;parseFloat(i);SDBrowser.name=t,SDBrowser.version=n,SDBrowser.engine=r,SDBrowser.engineVersion=i,e.name===SDBrowser_IE?SDBrowser_isIE=o:e.name===SDBrowser_FF?SDBrowser_isFF=o:e.name===SDBrowser_SAFARI?SDBrowser_isSafari=o:e.name===SDBrowser_CHROME&&(SDBrowser_isChrome=o)}();var SDMath=SD.Math={},SDMath_max=Math.max,SDMath_min=Math.min,SDMath_clamp=SDMath.clamp=function(e,t,n){return SDMath_max(t,SDMath_min(n,e))},SDMath_ln=Math.log,SDMath_LN2=Math.LN2,SDMath_LN10=Math.LN10,SDMath_exp=Math.exp,SDMath_log=SDMath.log=function(e,t){return t?SDMath_ln(e)/SDMath_ln(t):SDMath_ln(e)},SDMath_log2=SDMath.log2=function(e){return SDMath_ln(e)/SDMath_LN2},SDMath_log10=SDMath.log10=function(e){return SDMath_ln(e)/SDMath_LN10},SDMath_morton=SDMath.morton=function(e){var t,n,o,r,i,s=arguments[0];for("object"==typeof s?(t=s.x,n=s.y):(t=s,n=arguments[1]),o=0,r=0,i=1;i<=t||i<=n;)i&t&&(o|=1<<2*r+1),i&n&&(o|=1<<2*r),r++,i=1<<r;return o},SDMath_reverseMorton=SDMath.reverseMorton=function(e){for(var t,n=[],o=[],r=0,i=0;e>0;)o.push(e%2),e>>=1,n.push(e%2),e>>=1;for(t=0;t<n.length;t++)r+=(1<<t)*n[t];for(t=0;t<o.length;t++)i+=(1<<t)*o[t];return new SDPoint(r,i)},SDMath_ceil=Math.ceil,SDMath_floor=Math.floor,SDMath_round=SDMath.round=function(e,t,n){return"undefined"==typeof n&&(n=1),"undefined"==typeof t&&(t=.5),e/=n,(e%1+1)%1<t?SDMath_floor(e)*n:SDMath_ceil(e)*n},SDUri=SD.Uri={},SDUri_FILE_HOSTNAME=SDUri.FILE_HOSTNAME="localhost",SDUri_PAGE_HOSTNAME=location.hostname||SDUri_FILE_HOSTNAME,SDUri_getHostname=SDUri.getHostname=function(e){var t,n=/^http[s]?:\/\/([\w-.]+)/i.exec(e);return n?n[1].toLowerCase():(t=/^file:\/\//i.exec(e))?SDUri_FILE_HOSTNAME:SDUri_PAGE_HOSTNAME},SDXml=SD.Xml={},SDXml_fetch=SDXml.fetch=function(){function e(e,t){return function(){4===this.readyState&&(0===this.status||this.status>=200&&this.status<300?e.call(this):t.call(this))}}var t,n,o,r,i=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml3.XMLHTTP"],s="undefined"!=typeof XDomainRequest;if("undefined"!=typeof XMLHttpRequest)o=XMLHttpRequest;else if("undefined"!=typeof ActiveXObject){for(n=0;n<i.length;n++){t=i[n];try{new ActiveXObject(t),o=ActiveXObject,r=t;break}catch(u){SDDebug_warn("Seadragon2.Xml: {0} ActiveX failed.",t)}}n>=i.length&&SDDebug_error("Seadragon2.Xml: no ActiveX worked.")}else SDDebug_error("Seadragon2.Xml: no fetching ability.");return o?function(t,n,i,u,S){var c=new o(r),a=u?"POST":"GET",D=!1;c.onreadystatechange=e(n,i),t=t.replace(/#.*/,"");try{c.open(a,t,!0)}catch(h){if(!s)throw h;c=new XDomainRequest,c.onload=n,c.onerror=i,c.timeout=3e4,c.ontimeout=function(){},c.onprogress=function(){},c.open(a,t),D=!0}return u&&c.setRequestHeader&&c.setRequestHeader("Content-Type",S||"text/plain"),D?setTimeout(function(){c.send(u||null)},0):c.send(u||null),c}:SDFunction_EMPTY}(),SDXml_parse=SDXml.parse=function(){return"undefined"!=typeof DOMParser?function(e){var t=new DOMParser,n=t.parseFromString(e,"text/xml"),o=n&&n.documentElement;return o&&"parsererror"!==o.nodeName?n:null}:"undefined"!=typeof ActiveXObject?function(e){var t=new ActiveXObject("Microsoft.XMLDOM");return t.async=!1,t.loadXML(e)&&t}:(SDDebug_error("Seadragon2.Xml: no parsing ability."),SDFunction_EMPTY)}(),SDElement=SD.Element={},SDElement_$=SDElement.$=function(e){return"string"==typeof e?document.getElementById(e):e},SDElement_getWindowDimensions=SDElement.getWindowDimensions=function(){return(SDElement_getWindowDimensions="undefined"!=typeof innerWidth?SDElement.getWindowDimensions=function(){return new SDRect(0,0,innerWidth,innerHeight)}:document.documentElement&&document.documentElement.clientHeight?SDElement.getWindowDimensions=function(){var e=document.documentElement;return new SDRect(0,0,e.clientWidth,e.clientHeight)}:document.body.clientHeight?SDElement.getWindowDimensions=function(){var e=document.body;return new SDRect(0,0,e.clientWidth,e.clientHeight)}:SDElement.getWindowDimensions=function(){return new SDRect(0,0,1/0,1/0)})()},SDElement_getBoundingClientRect=SDElement.getBoundingClientRect=function(e){var t=e.getBoundingClientRect();return new SDRect(t.left,t.top,t.right-t.left,t.bottom-t.top)},SDElement_getStyle=SDElement.getStyle=function(e){return window.getComputedStyle?getComputedStyle(e,null):e.currentStyle?e.currentStyle:void SDDebug_error("Unknown element style, no known technique.")},SDElement_getOffsetParent=SDElement.getOffsetParent=function(e,t){return t&&e!==document.body?document.body:e.offsetParent},SDElement_getPosition=SDElement.getPosition=function(e){for(var t=new SDPoint,n="fixed"===SDElement_getStyle(e).position,o=SDElement_getOffsetParent(e,n);o;)t.x+=e.offsetLeft,t.y+=e.offsetTop,n&&(t=t.plus(SDPage_getScroll())),e=o,n="fixed"===SDElement_getStyle(e).position,o=SDElement_getOffsetParent(e,n);return t},SDElement_getClippingBounds=SDElement.getClippingBounds=function(e,t,n){t=t||SDElement_getBoundingClientRect(e),n=n||SDElement_getWindowDimensions();var o,r,i,s,u=t.y,S=t.width+t.x,c=t.height+t.y,a=t.x,D=n.x,h=n.y,l=D+n.width,f=h+n.height;return o=SDMath_max(0,h-u),r=SDMath_max(0,D-a),i=SDMath_min(S,l)-a-r,s=SDMath_min(c,f)-u-o,new SDRect(r,o,i,s)},SDElement_setOpacity=SDElement.setOpacity=function(){var e=document.createElement("div");return"undefined"!=typeof e.style.opacity?function(e,t){e.style.opacity=t}:"undefined"!=typeof e.style.filter?function(e,t){var n,o,r,i="progid:DXImageTransform.Microsoft.Alpha(Opacity="+100*t+")";for(e.style.filter=i,n=e.children,r=n.length,o=0;o<r;o++)try{SDElement_setOpacity(n[o],t)}catch(s){}}:function(){}}(),SDElement_customElements={},SDElement_dce=document.createElement,SDElement_registerCustomElement=function(e,t){SDElement_customElements["sd_"+e]=t,SDElement_dce.call(document,e)},SDElement_transform=SDElement.transform=function(){var e,t,n,o,r=["MozTransform","msTransform","OTransform","WebkitTransform","transform"],i=document.documentElement.style,s="";for(e=r.length-1;e>=0;e--)if("undefined"!=typeof i[r[e]]){t=r[e],n=t+"Origin";break}return"MozTransform"===t&&(s="px"),o=t?function(e,o,r,i){var u=e.sdStyle;u||(u=e.sdStyle=e.style,u[n]="0 0"),o+=s,r+=s,i+=",",u[t]="matrix("+i+"0,0,"+i+o+","+r+")"}:function(e,t,n,o){var r=e.style;r.left=t+"px",r.top=n+"px",r.fontSize=o+"em",r.width=100*o+"%",r.height=100*o+"%"}}();document.createElement=function(e){var t=SDElement_customElements["sd_"+e];return t?new t:SDElement_dce.apply(this,arguments)};var SDEvent=SD.Event={},SDEvent_$=SDEvent.$=function(e){return e?e:"undefined"!=typeof event?event:null},SDEvent_raise=SDEvent.raise=function(){return document.createEvent?function(e,t,n){n=n||!1;var o=document.createEvent("HTMLEvents");return o.initEvent(t,n,!0),e.dispatchEvent(o)}:document.createEventObject?function(e,t){var n=document.createEventObject();try{return e.fireEvent("on"+t,n)}catch(o){SDDebug_warn("Event not fired: "+t+". "+o.message)}}:(SDDebug_error("Seadragon2.Event: no raise ability."),SDFunction_EMPTY)}(),SDEvent_cancel=function(e){e=SDEvent_$(e),e.preventDefault&&e.preventDefault(),e.cancel=!0,e.returnValue=!1},SDEvent_stop=function(e){e=SDEvent_$(e),e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0},SDEvent_add=SDEvent.add=function(){return"function"==typeof addEventListener?function(e,t,n,o){o=o||!1,e.addEventListener(t,n,o),"mousewheel"===t?e.addEventListener("DOMMouseScroll",n,o):"DOMMouseScroll"===t&&e.addEventListener("mousewheel",n,o)}:"undefined"!=typeof attachEvent?function(e,t,n,o){e.attachEvent("on"+t,n),"DOMMouseScroll"===t&&e.attachEvent("onmousewheel",n),o&&e.setCapture&&e.setCapture()}:(SDDebug_error("Seadragon2.Event: no add ability."),SDFunction_EMPTY)}(),SDEvent_remove=SDEvent.remove=function(){return"function"==typeof removeEventListener?function(e,t,n,o){o=o||!1,e.removeEventListener(t,n,o),"mousewheel"===t?e.removeEventListener("DOMMouseScroll",n,o):"DOMMouseScroll"===t&&e.removeEventListener("mousewheel",n,o)}:"undefined"!=typeof detachEvent?function(e,t,n,o){e.detachEvent("on"+t,n),"DOMMouseScroll"===t&&e.detachEvent("onmousewheel",n),o&&e.releaseCapture&&e.releaseCapture()}:(SDDebug_error("Seadragon2.Event: no remove ability."),SDFunction_EMPTY)}(),SDTimer=SD.Timer=new function(){function e(){var e,t,n=(new Date).getTime();for(e=u;e;e=e.next){try{t=e.callback(e.arg,n)}catch(o){SDDebug_warn("Exception caught in timer: "+o.message)}t||s.unregister(e)}}var t,n,o,r,i,s=this,u=null,S=16,c=null;this.register=function(e,t){var o={callback:e,arg:t};return o.next=u,u&&(u.prev=o),o.prev=null,u=o,n(),o},this.unregister=function(e){e.dead||(e.next&&(e.next.prev=e.prev),e.prev?e.prev.next=e.next:u=e.next,u||o(),e.dead=!0)},"function"==typeof requestAnimationFrame?r=requestAnimationFrame:"function"==typeof mozRequestAnimationFrame?r=mozRequestAnimationFrame:"function"==typeof webkitRequestAnimationFrame?r=webkitRequestAnimationFrame:"function"==typeof msRequestAnimationFrame&&(r=msRequestAnimationFrame),r?(t=function(){return i?(i=!1,void(c=null)):(e(),void r(t))},n=function(){i=!1,c||(c=!0,r(t))},o=function(){c&&(i=!0)}):(n=function(){null===c&&(c=setInterval(e,S))},o=function(){null!==c&&(clearInterval(c),c=null)})},SDEventManager=SD.EventManager=function(){var e={};this.addListener=function(t,n){"function"==typeof n&&(e.hasOwnProperty(t)||(e[t]=[]),e[t].push(n))},this.removeListener=function(t,n){var o=e[t];if("function"==typeof n&&o){var r,i=o.length;for(r=0;r<i;r++)if(n===o[r])return void o.splice(r,1)}},this.clearListeners=function(t){e.hasOwnProperty(t)&&delete e[t]},this.listListeners=function(t){if(e.hasOwnProperty(t)){var n=e[t];if(n&&n.length)return n.slice(0)}},this.trigger=function(t){var n=e[t],o=[].slice.call(arguments,1);if(n){n=n.slice(0);var r,i=n.length;for(r=0;r<i;r++)try{n[r].apply(window,o)}catch(s){SDDebug_warn(s.name+" while executing "+t+" handler: "+s.message,s)}}}},SDMouse=SD.Mouse={},SDMouse_getPosition=SDMouse.getPosition=function(e){var t=new SDPoint;return"DOMMouseScroll"===e.type&&SDBrowser_isFF<3?(t.x=e.screenX,t.y=e.screenY):"number"==typeof e.pageX?(t.x=e.pageX,t.y=e.pageY):"number"==typeof e.clientX?(t.x=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,t.y=e.clientY+document.body.scrollTop+document.documentElement.scrollTop):SDDebug_error("Unknown event mouse position, no known technique."),t},SDMouse_getScroll=SDMouse.getScroll=function(e){var t=0;return"number"==typeof e.wheelDelta?t=e.wheelDelta:"number"==typeof e.detail?t=-e.detail:Seadragon2.Debug.fail("Unknown event mouse scroll, no known technique."),t?t/Math.abs(t):0};