function SDBrowser_parseUserAgent(t){var e=null,n=null,i=null,o=null,r=/MSIE ([^\s;)]+)/.exec(t),s=/Firefox\/(\S+)/.exec(t),a=/Safari\/(\S+)/.exec(t),u=/Chrome\/(\S+)/.exec(t),c=/Version\/(\S+)/.exec(t),S=/; Trident\/([^\s;)]+)/.exec(t),h=/rv\:([^\s)]+)\) Gecko\//.exec(t),l=/WebKit\/(\S+)/.exec(t);return r?(e=SDBrowser_IE,n=r[1],i=SDBrowser_TRIDENT,S&&(o=S[1])):h?(i=SDBrowser_GECKO,o=h[1],s&&(e=SDBrowser_FF,n=s[1])):l&&(i=SDBrowser_WEBKIT,o=l[1],u?(e=SDBrowser_CHROME,n=u[1]):a&&c&&(e=SDBrowser_SAFARI,n=c[1],o=a[1])),{name:e,version:n,engine:i,engineVersion:o}}function SDPage_getScroll(){var t=new SDPoint,e=document.documentElement||{},n=document.body||{};return"number"==typeof window.pageXOffset?(t.x=pageXOffset,t.y=pageYOffset):n.scrollLeft||n.scrollTop?(t.x=n.scrollLeft,t.y=n.scrollTop):(e.scrollLeft||e.scrollTop)&&(t.x=e.scrollLeft,t.y=e.scrollTop),t}"undefined"==typeof Seadragon2&&(window.Seadragon2={});var SD=Seadragon2,SD_VERSION=SD.VERSION="2.0.pre";SD.toString=function(){return"Seadragon Ajax v"+SD_VERSION+"\nCopyright (c) Microsoft Corp."};var SDPoint=SD.Point=function(t,e){this.x=t||0,this.y=e||0},SDPoint_$=SDPoint.$=function(t){return t instanceof SDPoint?t:(t=t||{},new SDPoint(t.x,t.y))},SDPointPrototype=SDPoint.prototype,SDPoint_origin=new SDPoint(0,0);SDPointPrototype.plus=function(t){return new SDPoint(this.x+t.x,this.y+t.y)},SDPointPrototype.minus=function(t){return new SDPoint(this.x-t.x,this.y-t.y)},SDPointPrototype.times=function(t){return new SDPoint(this.x*t,this.y*t)},SDPointPrototype.divide=function(t){return new SDPoint(this.x/t,this.y/t)},SDPointPrototype.negate=function(){return new SDPoint((-this.x),(-this.y))},SDPointPrototype.apply=function(t){return new SDPoint(t(this.x),t(this.y))},SDPointPrototype.distanceTo=function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},SDPointPrototype.asSize=function(){return new SDSize(this.x,this.y)},SDPointPrototype.equals=function(t){return this.x===(t.x||0)&&this.y===(t.y||0)},SDPointPrototype.toString=function(){return["(",this.x,",",this.y,")"].join("")};var SDSize=SD.Size=function(t,e){this.width=t||0,this.height=e||0},SDSize_$=SDSize.$=function(t){return t instanceof SDSize?t:(t=t||{},new SDSize(t.width,t.height))},SDSizePrototype=SDSize.prototype;SDSizePrototype.plus=function(t){return new SDSize(this.width+t.width,this.height+t.height)},SDSizePrototype.minus=function(t){return new SDSize(this.width-t.width,this.height-t.height)},SDSizePrototype.times=function(t){return new SDSize(this.width*t,this.height*t)},SDSizePrototype.divide=function(t){return new SDSize(this.width/t,this.height/t)},SDSizePrototype.negate=function(){return new SDSize((-this.width),(-this.height))},SDSizePrototype.apply=function(t){return new SDSize(t(this.width),t(this.height))},SDSizePrototype.asPoint=function(){return new SDPoint(this.width,this.height)},SDSizePrototype.equals=function(t){return this.width===(t.width||0)&&this.height===(t.height||0)},SDSizePrototype.toString=function(){return["(",this.width,"x",this.height,")"].join("")};var SDRect=SD.Rect=function(t,e,n,i){t&&void 0===n&&void 0!==t.x&&(n=e.width,i=e.height,e=t.y,t=t.x),this.x=t||0,this.y=e||0,this.width=n||0,this.height=i||0},SDRect_$=SDRect.$=function(t){return t instanceof SDRect?t:new SDRect(t.x,t.y,t.width,t.height)},SDRectPrototype=SDRect.prototype,SDRect_unitRect=new SDRect(0,0,1,1),SDRect_nullRect=new SDRect((-1),(-1),(-1),(-1));SDRectPrototype.getArea=function(){return this.width*this.height},SDRectPrototype.getAspectRatio=function(){return this.width/this.height},SDRectPrototype.getNormHeight=function(){return this.height/this.width},SDRectPrototype.getTopLeft=function(){return new SDPoint(this.x,this.y)},SDRectPrototype.getBottomRight=function(){return new SDPoint(this.x+this.width,this.y+this.height)},SDRectPrototype.getCenter=function(){return new SDPoint(this.x+this.width/2,this.y+this.height/2)},SDRectPrototype.getSize=function(){return new SDSize(this.width,this.height)},SDRectPrototype.contains=function(t){var e=this.x+this.width,n=this.y+this.height,i=t.x+(t.width||0),o=t.y+(t.height||0);return this.x<=t.x&&this.y<=t.y&&e>=i&&n>=o},SDRectPrototype.union=function(t){var e=Math.min(this.x,t.x),n=Math.min(this.y,t.y),i=Math.max(this.x+this.width,t.x+(t.width||0)),o=Math.max(this.y+this.height,t.y+(t.height||0));return new SDRect(e,n,i-e,o-n)},SDRectPrototype.intersect=function(t){var e=Math.max(this.x,t.x),n=Math.max(this.y,t.y),i=-e+Math.min(this.x+this.width,t.x+(t.width||0)),o=-n+Math.min(this.y+this.height,t.y+(t.height||0));return i||o||t instanceof SDRect?i<0||o<0?null:new SDRect(e,n,i,o):new SDPoint(e,n)},SDRectPrototype.scale=function(t,e){var n=e?e.x:this.x,i=e?e.y:this.y;return new SDRect(n-t*(n-this.x),i-t*(i-this.y),this.width*t,this.height*t)},SDRectPrototype.translate=function(t){return new SDRect(this.x+(t.x||0),this.y+(t.y||0),this.width,this.height)},SDRectPrototype.equals=function(t){return this.x===(t.x||0)&&this.y===(t.y||0)&&this.width===(t.width||0)&&this.height===(t.height||0)},SDRectPrototype.toString=function(){return["[",this.x,",",this.y,"|",this.width,"x",this.height,"]"].join("")};var SDString=SD.String={},SDString_format=SDString.format=function(t,e){var n,i;if(2===arguments.length&&e&&e.constructor&&(e.constructor===Array||e.constructor===Object))n=e;else for(n=new Array(arguments.length-1),i=0;i<n.length;i++)n[i]=arguments[i+1];return t.replace(/\{[\d\w]+\}/g,function(t){var e=t.match(/[\d\w]+/);return n[e]||""})},SDDebug=SD.Debug={alert:0,enabled:3},SDDebug_log=SDDebug.log=function(t,e){SDDebug.enabled<3||(arguments.length>1&&(t=SDString_format.apply(this,arguments)),"undefined"!=typeof console&&console.log?console.log(t):SDDebug.alert>=3&&alert(t))},SDDebug_warn=SDDebug.warn=function(t){SDDebug.enabled<2||(arguments.length>1&&(t=SDString_format.apply(this,arguments)),"undefined"!=typeof console&&console.warn?console.warn(t):SDDebug.alert>=2&&alert(t))},SDDebug_error=SDDebug.error=function(t,e){if(!(SDDebug.enabled<1))throw"undefined"!=typeof console&&console.error?console.error(t):SDDebug.alert>=1&&alert(t),e||new Error(t)},SDObject=SD.Object={},SDObject_extend=SDObject.extend=function(t,e,n){for(var i in e)(n||e.hasOwnProperty(i))&&(t[i]=e[i]);return t},SDObject_clone=SDObject.clone=function(t,e){return SDObject_extend({},t,e)},SDFunction=SD.Function={},SDFunction_EMPTY=SDFunction.EMPTY=function(){},SDFunction_bind=SDFunction.bind=function(t,e,n){var i,o=new Array(arguments.length-2),r=o.length;for(i=0;i<r;i++)o[i]=arguments[i+2];return"string"==typeof e&&(e=t[e]),function(){var n,i=arguments.length;for(n=0;n<i;n++)o.push(arguments[n]);e.apply(t,o)}},SDFunction_callback=SDFunction.callback=function(t,e){var n,i=arguments.length,o=new Array(i+1);for(o[0]=null,n=0;n<i;n++)o[n+1]=arguments[n];return SDFunction_bind.apply(SDFunction,o)},SDFunction_delay=SDFunction.delay=function(t,e){return function(){setTimeout(SDFunction_bind(this,t),e)}},SDBrowser=SD.Browser={},SDBrowser_TRIDENT=SDBrowser.TRIDENT="Trident",SDBrowser_GECKO=SDBrowser.GECKO="Gecko",SDBrowser_WEBKIT=SDBrowser.WEBKIT="Webkit",SDBrowser_PRESTO=SDBrowser.PRESTO="Presto",SDBrowser_IE=SDBrowser.IE="IE",SDBrowser_FF=SDBrowser.FIREFOX="Firefox",SDBrowser_SAFARI=SDBrowser.SAFARI="Safari",SDBrowser_CHROME=SDBrowser.CHROME="Chrome",SDBrowser_OPERA=SDBrowser.OPERA="Opera",SDBrowser_isIE,SDBrowser_isFF,SDBrowser_isSafari,SDBrowser_isChrome,SDBrowser_isGecko,SDBrowser_isWebkit,SDBrowser_isOpera;!function(){var t=SDBrowser_parseUserAgent(navigator.userAgent),e=t.name,n=t.version,i=parseInt(n),o=(parseFloat(n),t.engine),r=t.engineVersion;parseFloat(r);SDBrowser.name=e,SDBrowser.version=n,SDBrowser.engine=o,SDBrowser.engineVersion=r,t.name===SDBrowser_IE?SDBrowser_isIE=i:t.name===SDBrowser_FF?SDBrowser_isFF=i:t.name===SDBrowser_SAFARI?SDBrowser_isSafari=i:t.name===SDBrowser_CHROME&&(SDBrowser_isChrome=i)}();var SDMath=SD.Math={},SDMath_max=Math.max,SDMath_min=Math.min,SDMath_clamp=SDMath.clamp=function(t,e,n){return SDMath_max(e,SDMath_min(n,t))},SDMath_ln=Math.log,SDMath_LN2=Math.LN2,SDMath_LN10=Math.LN10,SDMath_exp=Math.exp,SDMath_log=SDMath.log=function(t,e){return e?SDMath_ln(t)/SDMath_ln(e):SDMath_ln(t)},SDMath_log2=SDMath.log2=function(t){return SDMath_ln(t)/SDMath_LN2},SDMath_log10=SDMath.log10=function(t){return SDMath_ln(t)/SDMath_LN10},SDMath_morton=SDMath.morton=function(t){var e,n,i,o,r,s=arguments[0];for("object"==typeof s?(e=s.x,n=s.y):(e=s,n=arguments[1]),i=0,o=0,r=1;r<=e||r<=n;)r&e&&(i|=1<<2*o+1),r&n&&(i|=1<<2*o),o++,r=1<<o;return i},SDMath_reverseMorton=SDMath.reverseMorton=function(t){for(var e,n=[],i=[],o=0,r=0;t>0;)i.push(t%2),t>>=1,n.push(t%2),t>>=1;for(e=0;e<n.length;e++)o+=(1<<e)*n[e];for(e=0;e<i.length;e++)r+=(1<<e)*i[e];return new SDPoint(o,r)},SDMath_ceil=Math.ceil,SDMath_floor=Math.floor,SDMath_round=SDMath.round=function(t,e,n){return"undefined"==typeof n&&(n=1),"undefined"==typeof e&&(e=.5),t/=n,(t%1+1)%1<e?SDMath_floor(t)*n:SDMath_ceil(t)*n},SDUri=SD.Uri={},SDUri_FILE_HOSTNAME=SDUri.FILE_HOSTNAME="localhost",SDUri_PAGE_HOSTNAME=location.hostname||SDUri_FILE_HOSTNAME,SDUri_getHostname=SDUri.getHostname=function(t){var e,n=/^http[s]?:\/\/([\w-.]+)/i.exec(t);return n?n[1].toLowerCase():(e=/^file:\/\//i.exec(t))?SDUri_FILE_HOSTNAME:SDUri_PAGE_HOSTNAME},SDXml=SD.Xml={},SDXml_fetch=SDXml.fetch=function(){function t(t,e){return function(){4===this.readyState&&(0===this.status||this.status>=200&&this.status<300?t.call(this):e.call(this))}}var e,n,i,o,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml3.XMLHTTP"],s="undefined"!=typeof XDomainRequest;if("undefined"!=typeof XMLHttpRequest)i=XMLHttpRequest;else if("undefined"!=typeof ActiveXObject){for(n=0;n<r.length;n++){e=r[n];try{new ActiveXObject(e),i=ActiveXObject,o=e;break}catch(a){SDDebug_warn("Seadragon2.Xml: {0} ActiveX failed.",e)}}n>=r.length&&SDDebug_error("Seadragon2.Xml: no ActiveX worked.")}else SDDebug_error("Seadragon2.Xml: no fetching ability.");return i?function(e,n,r,a,u){var c=new i(o),S=a?"POST":"GET",h=!1;c.onreadystatechange=t(n,r),e=e.replace(/#.*/,"");try{c.open(S,e,!0)}catch(l){if(!s)throw l;c=new XDomainRequest,c.onload=n,c.onerror=r,c.timeout=3e4,c.ontimeout=function(){},c.onprogress=function(){},c.open(S,e),h=!0}return a&&c.setRequestHeader&&c.setRequestHeader("Content-Type",u||"text/plain"),h?setTimeout(function(){c.send(a||null)},0):c.send(a||null),c}:SDFunction_EMPTY}(),SDXml_parse=SDXml.parse=function(){return"undefined"!=typeof DOMParser?function(t){var e=new DOMParser,n=e.parseFromString(t,"text/xml"),i=n&&n.documentElement;return i&&"parsererror"!==i.nodeName?n:null}:"undefined"!=typeof ActiveXObject?function(t){var e=new ActiveXObject("Microsoft.XMLDOM");return e.async=!1,e.loadXML(t)&&e}:(SDDebug_error("Seadragon2.Xml: no parsing ability."),SDFunction_EMPTY)}(),SDElement=SD.Element={},SDElement_$=SDElement.$=function(t){return"string"==typeof t?document.getElementById(t):t},SDElement_getWindowDimensions=SDElement.getWindowDimensions=function(){return(SDElement_getWindowDimensions="undefined"!=typeof innerWidth?SDElement.getWindowDimensions=function(){return new SDRect(0,0,innerWidth,innerHeight)}:document.documentElement&&document.documentElement.clientHeight?SDElement.getWindowDimensions=function(){var t=document.documentElement;return new SDRect(0,0,t.clientWidth,t.clientHeight)}:document.body.clientHeight?SDElement.getWindowDimensions=function(){var t=document.body;return new SDRect(0,0,t.clientWidth,t.clientHeight)}:SDElement.getWindowDimensions=function(){return new SDRect(0,0,1/0,1/0)})()},SDElement_getBoundingClientRect=SDElement.getBoundingClientRect=function(t){var e=t.getBoundingClientRect();return new SDRect(e.left,e.top,e.right-e.left,e.bottom-e.top)},SDElement_getStyle=SDElement.getStyle=function(t){return window.getComputedStyle?getComputedStyle(t,null):t.currentStyle?t.currentStyle:void SDDebug_error("Unknown element style, no known technique.")},SDElement_getOffsetParent=SDElement.getOffsetParent=function(t,e){return e&&t!==document.body?document.body:t.offsetParent},SDElement_getPosition=SDElement.getPosition=function(t){for(var e=new SDPoint,n="fixed"===SDElement_getStyle(t).position,i=SDElement_getOffsetParent(t,n);i;)e.x+=t.offsetLeft,e.y+=t.offsetTop,n&&(e=e.plus(SDPage_getScroll())),t=i,n="fixed"===SDElement_getStyle(t).position,i=SDElement_getOffsetParent(t,n);return e},SDElement_getClippingBounds=SDElement.getClippingBounds=function(t,e,n){e=e||SDElement_getBoundingClientRect(t),n=n||SDElement_getWindowDimensions();var i,o,r,s,a=e.y,u=e.width+e.x,c=e.height+e.y,S=e.x,h=n.x,l=n.y,D=h+n.width,d=l+n.height;return i=SDMath_max(0,l-a),o=SDMath_max(0,h-S),r=SDMath_min(u,D)-S-o,s=SDMath_min(c,d)-a-i,new SDRect(o,i,r,s)},SDElement_setOpacity=SDElement.setOpacity=function(){var t=document.createElement("div");return"undefined"!=typeof t.style.opacity?function(t,e){t.style.opacity=e}:"undefined"!=typeof t.style.filter?function(t,e){var n,i,o,r="progid:DXImageTransform.Microsoft.Alpha(Opacity="+100*e+")";for(t.style.filter=r,n=t.children,o=n.length,i=0;i<o;i++)try{SDElement_setOpacity(n[i],e)}catch(s){}}:function(){}}(),SDElement_customElements={},SDElement_dce=document.createElement,SDElement_registerCustomElement=function(t,e){SDElement_customElements["sd_"+t]=e,SDElement_dce.call(document,t)},SDElement_transform=SDElement.transform=function(){var t,e,n,i,o=["MozTransform","msTransform","OTransform","WebkitTransform","transform"],r=document.documentElement.style,s="";for(t=o.length-1;t>=0;t--)if("undefined"!=typeof r[o[t]]){e=o[t],n=e+"Origin";break}return"MozTransform"===e&&(s="px"),i=e?function(t,i,o,r){var a=t.sdStyle;a||(a=t.sdStyle=t.style,a[n]="0 0"),i+=s,o+=s,r+=",",a[e]="matrix("+r+"0,0,"+r+i+","+o+")"}:function(t,e,n,i){var o=t.style;o.left=e+"px",o.top=n+"px",o.fontSize=i+"em",o.width=100*i+"%",o.height=100*i+"%"}}();document.createElement=function(t){var e=SDElement_customElements["sd_"+t];return e?new e:SDElement_dce.apply(this,arguments)};var SDEvent=SD.Event={},SDEvent_$=SDEvent.$=function(t){return t?t:"undefined"!=typeof event?event:null},SDEvent_raise=SDEvent.raise=function(){return document.createEvent?function(t,e,n){n=n||!1;var i=document.createEvent("HTMLEvents");return i.initEvent(e,n,!0),t.dispatchEvent(i)}:document.createEventObject?function(t,e){var n=document.createEventObject();try{return t.fireEvent("on"+e,n)}catch(i){SDDebug_warn("Event not fired: "+e+". "+i.message)}}:(SDDebug_error("Seadragon2.Event: no raise ability."),SDFunction_EMPTY)}(),SDEvent_cancel=function(t){t=SDEvent_$(t),t.preventDefault&&t.preventDefault(),t.cancel=!0,t.returnValue=!1},SDEvent_stop=function(t){t=SDEvent_$(t),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0},SDEvent_add=SDEvent.add=function(){return"function"==typeof addEventListener?function(t,e,n,i){i=i||!1,t.addEventListener(e,n,i),"mousewheel"===e?t.addEventListener("DOMMouseScroll",n,i):"DOMMouseScroll"===e&&t.addEventListener("mousewheel",n,i)}:"undefined"!=typeof attachEvent?function(t,e,n,i){t.attachEvent("on"+e,n),"DOMMouseScroll"===e&&t.attachEvent("onmousewheel",n),i&&t.setCapture&&t.setCapture()}:(SDDebug_error("Seadragon2.Event: no add ability."),SDFunction_EMPTY)}(),SDEvent_remove=SDEvent.remove=function(){return"function"==typeof removeEventListener?function(t,e,n,i){i=i||!1,t.removeEventListener(e,n,i),"mousewheel"===e?t.removeEventListener("DOMMouseScroll",n,i):"DOMMouseScroll"===e&&t.removeEventListener("mousewheel",n,i)}:"undefined"!=typeof detachEvent?function(t,e,n,i){t.detachEvent("on"+e,n),"DOMMouseScroll"===e&&t.detachEvent("onmousewheel",n),i&&t.releaseCapture&&t.releaseCapture()}:(SDDebug_error("Seadragon2.Event: no remove ability."),SDFunction_EMPTY)}(),SDTimer=SD.Timer=new function(){function t(){var t,e,n=(new Date).getTime();for(t=a;t;t=t.next)e=t.callback(t.arg,n),e||s.unregister(t)}var e,n,i,o,r,s=this,a=null,u=16,c=null;this.register=function(t,e){var i={callback:t,arg:e};return i.next=a,a&&(a.prev=i),i.prev=null,a=i,n(),i},this.unregister=function(t){t.dead||(t.next&&(t.next.prev=t.prev),t.prev?t.prev.next=t.next:a=t.next,a||i(),t.dead=!0)},"function"==typeof requestAnimationFrame?o=requestAnimationFrame:"function"==typeof mozRequestAnimationFrame?o=mozRequestAnimationFrame:"function"==typeof webkitRequestAnimationFrame?o=webkitRequestAnimationFrame:"function"==typeof msRequestAnimationFrame&&(o=msRequestAnimationFrame),o?(e=function(){return r?(r=!1,void(c=null)):(t(),void o(e))},n=function(){r=!1,c||(c=!0,o(e))},i=function(){c&&(r=!0)}):(n=function(){null===c&&(c=setInterval(t,u))},i=function(){null!==c&&(clearInterval(c),c=null)})},SDEventManager=SD.EventManager=function(){var t={};this.addListener=function(e,n){"function"==typeof n&&(t.hasOwnProperty(e)||(t[e]=[]),t[e].push(n))},this.removeListener=function(e,n){var i=t[e];if("function"==typeof n&&i){var o,r=i.length;for(o=0;o<r;o++)if(n===i[o])return void i.splice(o,1)}},this.clearListeners=function(e){t.hasOwnProperty(e)&&delete t[e]},this.listListeners=function(e){if(t.hasOwnProperty(e)){var n=t[e];if(n&&n.length)return n.slice(0)}},this.trigger=function(e){var n=t[e],i=[].slice.call(arguments,1);if(n){n=n.slice(0);var o,r=n.length;for(o=0;o<r;o++)try{n[o].apply(window,i)}catch(s){SDDebug_warn(s.name+" while executing "+e+" handler: "+s.message,s)}}}},SDMouse=SD.Mouse={},SDMouse_getPosition=SDMouse.getPosition=function(t){var e=new SDPoint;return"DOMMouseScroll"===t.type&&SDBrowser_isFF<3?(e.x=t.screenX,e.y=t.screenY):"number"==typeof t.pageX?(e.x=t.pageX,e.y=t.pageY):"number"==typeof t.clientX?(e.x=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,e.y=t.clientY+document.body.scrollTop+document.documentElement.scrollTop):SDDebug_error("Unknown event mouse position, no known technique."),e},SDMouse_getScroll=SDMouse.getScroll=function(t){var e=0;return"number"==typeof t.wheelDelta?e=t.wheelDelta:"number"==typeof t.detail?e=-t.detail:Seadragon2.Debug.fail("Unknown event mouse scroll, no known technique."),e?e/Math.abs(e):0};!function(){function t(t){return SDMouse_getPosition(t)}function e(t,e){var n=SDMouse_getPosition(t),i=SDElement_getPosition(e);return n.minus(i)}function n(t,e){for(var n=document.body;e&&t!==e&&n!==e;)try{e=e.parentNode}catch(i){return!1}return t===e}function i(){h=!0}function o(){h=!1}if(!SD.MouseTracker){var r,s,a,u,c,S="function"!=typeof addEventListener,h=!1,l=!1,D={},d=[];navigator.msPointerEnabled?(r="MSPointerDown",s="MSPointerUp",a="MSPointerOver",u="MSPointerOut",c="MSPointerMove"):(r="mousedown",s="mouseup",a="mouseover",u="mouseout",c="mousemove"),S?(SDEvent_add(document,r,i,!1),SDEvent_add(document,s,o,!1)):(SDEvent_add(window,r,i,!0),SDEvent_add(window,s,o,!0)),SD.MouseTracker=function(i,o){function f(t,e){var n,i=D;for(n in i)i.hasOwnProperty(n)&&z!==n&&i[n][t](e)}function m(){var t;for(t in I)if(I.hasOwnProperty(t)&&I[t])return!0;return!1}function g(t){t=t||window.event,S&&L&&!n(t.srcElement,i)&&f("onMouseOver",t);var o=t.target||t.srcElement,r=t.relatedTarget||t.fromElement,s=t.pointerId||0;n(i,o)&&!n(i,r)&&(I[s]=!0,B.trigger("enter",B,s,e(t,i),!!A[s],h))}function p(t){t=t||window.event,S&&L&&!n(t.srcElement,i)&&f("onMouseOut",t);var o=t.target||t.srcElement,r=t.relatedTarget||t.toElement,s=t.pointerId||0;n(i,o)&&!n(i,r)&&(I[s]=!1,B.trigger("exit",B,s,e(t,i),!!A[s],h))}function w(n){if(n=n||window.event,2!==n.button){var o=n.pointerId||0;A[o]=!0,I[o]=!0,H[o]=Z[o]=t(n),k[o]=(new Date).getTime(),B.trigger("press",B,o,e(n,i)),(B.listListeners("press")||B.listListeners("drag"))&&SDEvent_cancel(n),S&&l?S&&d.push(O):(R(),l=!0,d=[O])}}function v(n){if(n=n||window.event,2!==n.button){var o=n.pointerId||0,r=(new Date).getTime()-k[o],s=t(n),a=H[o].distanceTo(s),u=r<=W&&a<=N,c=n.target,S=document.body,h=!1;for(c=n.target;c&&c!==i&&c!==S;c=c.parentNode)X.hasOwnProperty(c.tagName)&&(h=!0);B.trigger("click",B,o,e(n,i),u,n.shiftKey,h)}}function y(t){t=t||window.event;var n=t.pointerId||0,o=!!A[n],r=!!I[n];2!==t.button&&(A[n]=!1,B.trigger("release",B,n,e(t,i),o,r),o&&r&&v(t))}function _(t){t=t||window.event;var e,n;if(2!==t.button){for(e=0;e<d.length;e++)n=d[e],n.hasMouse()||n.onMouseUp(t);C(),l=!1,t.srcElement.fireEvent("on"+t.type,document.createEventObject(t)),SDEvent_stop(t)}}function E(t){I[t.pointerId||0]||y(t),C()}function x(n){n=n||window.event;var o=n.pointerId||0,r=t(n),s=r.minus(Z[o]||r);Z[o]=r,(s.x||s.y)&&B.trigger("drag",B,o,e(n,i),s,n.shiftKey),B.listListeners("drag")&&SDEvent_cancel(n)}function P(t){var e;for(e=0;e<d.length;e++)d[e].onMouseMove(t);SDEvent_stop(t)}function M(t){t=t||window.event;var n=SDMouse_getScroll(t);n&&B.trigger("scroll",B,e(t,i),n,t.shiftKey),B.listListeners("scroll")&&SDEvent_cancel(t)}function T(){F||(SDEvent_add(i,a,g,!1),SDEvent_add(i,u,p,!1),SDEvent_add(i,r,w,!1),SDEvent_add(i,s,y,!1),SDEvent_add(i,"mousewheel",M,!1),F=!0,D[z]=O)}function b(){if(F){for(SDEvent_remove(i,a,g,!1),SDEvent_remove(i,u,p,!1),SDEvent_remove(i,r,w,!1),SDEvent_remove(i,s,y,!1),SDEvent_remove(i,"mousewheel",M,!1);L;)C();F=!1,delete D[z]}}function R(){L||(S?(SDEvent_remove(i,s,y,!1),SDEvent_add(i,s,_,!0),SDEvent_add(i,c,P,!0)):(SDEvent_add(window,s,E,!0),SDEvent_add(window,c,x,!0))),++L}function C(){1===L&&(S?(SDEvent_remove(i,c,P,!0),SDEvent_remove(i,s,_,!0),SDEvent_add(i,s,y,!1)):(SDEvent_remove(window,c,x,!0),SDEvent_remove(window,s,E,!0))),--L}o=o||{};var O,B=this,z=Math.random(),F=!1,L=0,A={},I={},Z={},k={},H={},X={A:1,INPUT:1,TEXTAREA:1,SELECT:1,OPTION:1,OPTGROUP:1,BUTTON:1,LABEL:1},W=o.clickTimeThreshold||500,N=o.clickDistThreshold||5;this.target=i,O={hasMouse:m,onMouseOver:g,onMouseOut:p,onMouseUp:y,onMouseMove:x},SDEventManager.call(this),this.isTracking=function(){return F},this.setTracking=function(t){t?T():b()}}}}();var SDMouseTracker=SD.MouseTracker,SDSpring=SD.Spring=function(t){function e(t){return(1-SDMath_exp(-t*o))/r}t=t||{};var n,i=t.initialValue||0,o=t.stiffness||5,r=1-SDMath_exp(-o),s=t.animationTime||1.5,a=t.decayTime||1,u=i,c=i,S=(new Date).getTime(),h=S,l=S,D=0,d=!1;this.getCurrent=function(){return i},this.getTarget=function(){return c},this.resetTo=function(t){d=!1,c=t,l=S,u=c,h=l},this.springTo=function(t){d=!1,u=i,h=S,c=t,l=h+1e3*s},this.shiftBy=function(t){u+=t,c+=t},this.toss=function(){n=Math.abs(D/(1e3*a)),d=!0},this.grab=function(){d=!1},this.update=function(t){var o,r,s=S,a=i;return S=t||(new Date).getTime(),o=S-s,d?(D>0?(D-=n*o,D<0&&(D=0)):D<0&&(D+=n*o,D>0&&(D=0)),i+=D*o,c=i):(i=S>=l?c:u+(c-u)*e((S-h)/(l-h)),o&&(r=SDMath_exp(-o/40),D=r*D+(1-r)*(i-a)/o)),d}},SDSVGZoomContainer=SD.SVGZoomContainer=function(t){this.update=function(e){t.setAttribute("viewBox",[e.x,e.y,e.width,e.height].join(" "))}},SDHTMLZoomContainer=SD.HTMLZoomContainer=function(t){var e,n,i=document.createElement("div"),o=i.style,r=1;!function(){var e;for(o.width="100%",o.height="100%",o.position="relative",t.appendChild(i);(e=t.firstChild)!==i;)i.appendChild(e)}(),this.setSizeRatio=function(t,i){r=t,t=100*t+"%",o.width=t,o.height=t,i&&void 0!==e&&this.update(e,n)},this.setLocation=function(t,e){var n=t.style;n.left=e.x*r+"px",n.top=e.y*r+"px",n.width=e.width*r+"px",n.height=e.height*r+"px"},this.update=function(t,o){e=t,n=o,SDElement_transform(i,-t.x*o,-t.y*o,o/r)},this.dispose=function(){var e;for(t.removeChild(i);e=i.firstChild;)t.appendChild(e)}},SDCanvasZoomContainer=SD.CanvasZoomContainer=function(t){var e=t.getContext("2d");this.update=function(n){var i=t.width,o=t.height,r=i/n.width;e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,i,o),e.setTransform(r,0,0,r,-n.x*r,-n.y*r)}},SDViewport=SD.Viewport=function(t,e,n){function i(){SDEventManager.call(C),C.resizeContent(e),C.goHome(!0),C.update(),k&&SDTimer.register(C.update,H)}function o(t){return Math.pow(2,t)}function r(t,e){var n=t.x,i=t.y,o=SDMath_clamp(n,e.x,e.x+e.width),r=SDMath_clamp(i,e.y,e.y+e.height);return n===o&&i===r?t:new SDPoint(o,r)}function s(t){var e=C.getWidthZoom(t),n=f/e,i=n/A,o=(C.visibilityRatio-.5)*n,r=(C.visibilityRatio-.5)*i,s=f-2*o,a=d-2*r;return s<0&&(o+=.5*s,s=0),a<0&&(r+=.5*a,a=0),new SDRect(o,r,s,a)}function a(){var t=F.getCurrent(),e=F.getTarget();v=t,y=e,p=o(t),w=o(e),_=p*g,E=w*g;var n=SDMath_log2(C.minZoom),i=SDMath_log2(C.maxZoom);x=(v-n)/(i-n)*100,P=(y-n)/(i-n)*100}function u(e){var n=new SDPoint(B.getCurrent(),z.getCurrent()),i=new SDPoint(B.getTarget(),z.getTarget());if(e)return n;if(!L)return i;var o=C.getWidthZoom(),r=f/o,s=r/A,a=new SDRect(n.x-r/2,n.y-s/2,r,s),u=C.pixelFromPoint(L,!0),c=L.minus(a.getTopLeft()).times(t.x/a.width),S=c.minus(u),h=S.divide(t.x/f*o);return i.plus(h)}function c(t){var e=C.getCenter(t),n=f/C.getWidthZoom(t),i=n/A;return new SDRect(e.x-n/2,e.y-i/2,n,i)}function S(){X=!1,a(),M=u(!0),b=c(!0),T=u(),R=c()}function h(t){return new SDRect(t.x,t.y,t.width,t.height)}function l(t){return new SDPoint(t.x,t.y)}t=new SDPoint(t.x,t.y),n=n||{};var D,d,f,m,g,p,w,v,y,_,E,x,P,M,T,b,R,C=this,O=n.panSpringOptions||{animationTime:.35},B=new SDSpring(O),z=new SDSpring(O),F=new SDSpring(n.zoomSpringOptions),L=null,A=t.x/t.y,I=n.wrapHorizontal||!1,Z=n.wrapVertical||!1,k=n.selfUpdating!==!1,H={},X=!0;this.maxZoom="number"==typeof n.maxZoom?n.maxZoom:2,this.minZoom="number"==typeof n.minZoom?n.minZoom:.8,this.visibilityRatio="number"==typeof n.visibilityRatio?n.visibilityRatio:.8,this.getContainerSize=function(){return l(t)},this.getBounds=function(t){return X&&S(),h(t?b:R)},this.getCenter=function(t){return X&&S(),l(t?M:T)},this.getZoom=function(t){return X&&S(),t?p:w},this.getExpZoom=function(t){return X&&S(),t?v:y},this.getWidthZoom=function(t){return X&&S(),t?_:E},this.getZoomPercent=function(t){return X&&S(),t?x:P},this.applyConstraints=function(t){var e=C.getZoom(),n=SDMath_clamp(e,C.minZoom,C.maxZoom);e!==n&&C.zoomTo(n,L,t),n*=g;var i=C.getCenter(),o=r(i,s());if(I&&(o.x=i.x),Z&&(o.y=i.y),!i.equals(o)){var a=f/n,u=a/A;C.fitBounds(new SDRect(o.x-.5*a,o.y-.5*u,a,u),t)}},this.fitBounds=function(e,n){var i=A,o=e.getCenter(),r=new SDRect(e.x,e.y,e.width,e.height);r.getAspectRatio()>=i?(r.height=e.width/i,r.y=o.y-r.height/2):(r.width=e.height*i,r.x=o.x-r.width/2),C.panTo(C.getCenter(!0),!0),C.zoomTo(C.getZoom(!0),null,!0);var s=C.getBounds(),a=C.getWidthZoom(),u=f/r.width;if(1.000001*u>a&&.999999*u<a)return void C.panTo(o,n);var c=s.getTopLeft().times(t.x/s.width).minus(r.getTopLeft().times(t.x/r.width)).divide(t.x/s.width-t.x/r.width);C.zoomTo(u/g,c,n)},this.goHome=function(t){var e=C.getCenter();I&&(e.x=(f+e.x%f)%f,B.resetTo(e.x),B.update()),Z&&(e.y=(d+e.y%d)%d,z.resetTo(e.y),z.update()),C.fitBounds(m,t)},this.panBy=function(t,e){C.panTo(C.getCenter().plus(t),e)},this.panTo=function(e,n){if(n)return B.resetTo(e.x),z.resetTo(e.y),void(X=!0);if(!L)return B.springTo(e.x),z.springTo(e.y),void(X=!0);var i=C.getWidthZoom(),o=f/i,r=o/A,s=new SDRect(B.getCurrent()-o/2,z.getCurrent()-r/2,o,r),a=C.pixelFromPoint(L,!0),u=L.minus(s.getTopLeft()).times(t.x/s.width),c=u.minus(a),S=c.divide(t.x/f*i),h=e.minus(S);B.springTo(h.x),z.springTo(h.y),X=!0},this.zoomBy=function(t,e,n){C.zoomTo(C.getZoom()*t,e,n)},this.zoomTo=function(t,e,n){n?F.resetTo(SDMath_log2(t)):F.springTo(SDMath_log2(t)),L=e instanceof SDPoint?e:null,X=!0},this.toss=function(){B.toss(),z.toss()},this.resize=function(e,n){var i=C.getBounds(),o=i,r=e.x/t.x;t=new SDPoint(e.x,e.y),A=t.x/t.y,g=A>D?D/A:1,n&&(o.width=i.width*r,o.height=o.width/A),C.fitBounds(o,!0)},this.resizeContent=function(t){var n;n=C.getBounds(),e=t,D=e.x/e.y,d=e.y,f=e.x,m=new SDRect(0,0,f,d),g=A>D?D/A:1,X=!0,C.fitBounds(n,!0)},this.zoomToPercent=function(t,e){var n=SDMath_log2(C.minZoom);C.zoomTo(o(t*(SDMath_log2(C.maxZoom)-n)/100+n),null,e)},this.update=function(t,e){var n,i,o=B.getCurrent(),r=z.getCurrent(),s=F.getCurrent();if(e=e||(new Date).getTime(),L&&(n=C.pixelFromPoint(L,!0)),F.update(e),X=!0,L&&F.getCurrent()!==s){var a=C.pixelFromPoint(L,!0),u=a.minus(n),c=C.deltaPointsFromPixels(u,!0);B.shiftBy(c.x),z.shiftBy(c.y)}else L=null;i=B.update(e),i=z.update(e)||i,X=!0,i&&C.applyConstraints();var S=B.getCurrent()!==o||z.getCurrent()!==r||F.getCurrent()!==s;return S&&C.trigger("change",C),S||t===H},this.deltaPixelsFromPoints=function(e,n){return e.times(t.x/f*C.getWidthZoom(n))},this.deltaPointsFromPixels=function(e,n){return e.divide(t.x/f*C.getWidthZoom(n))},this.pixelFromPoint=function(e,n){var i=C.getBounds(n);return e.minus(i.getTopLeft()).times(t.x/i.width)},this.pointFromPixel=function(e,n){var i=C.getBounds(n);return e.divide(t.x/i.width).plus(i.getTopLeft())},this.rectPixelsFromPoints=function(e,n,i){var o=C.getBounds(n),r=t.x/o.width;return new SDRect((e.x-o.x)*r-(i?t.x/2:0),(e.y-o.y)*r-(i?t.y/2:0),e.width*r,e.height*r)},i()},SDViewer=SD.Viewer=function(t,e){function n(t,e){var n=t>1;h.zoomBy(t,n&&E.zoomInToPoint||!n&&E.zoomOutToPoint?h.pointFromPixel(e.minus(new SDPoint(E.padding.left,E.padding.top)),!0):null),h.applyConstraints()}function i(t){var e,n,i,o=0,r=0,s=0,a=0;for(e in t)if(t.hasOwnProperty(e)){++o,i=t[e],s+=i.x,a+=i.y;for(n in t)t.hasOwnProperty(n)&&n!==e&&(r+=i.distanceTo(t[n]))}return{center:new SDPoint(s/o,a/o),size:r/o/(o-1)}}function o(t,e,i,o,r,s){if(o&&E.isZoomable&&!s){var a=E.zoomPerClick,u=r?1/a:a;n(u,i)}}function r(t,e,n){if(x[e]=P[e]=n,++R,D=h.getCenter(),R>1){var o=i(x);n=o.center,g=n,p=o.size,w=h.getZoom(),v=h.pointFromPixel(n.minus(new SDPoint(E.padding.left,E.padding.top)),!0)}}function s(t,e,n,o){P[e]=n;var r,s=-1;if(R>1){var a=i(P);n=a.center,s=a.size,r=g}else r=x[e];if(E.isZoomable&&s>=0){var u=s/p,c=u*w;h.zoomTo(c,void 0,!0);var S=h.deltaPointsFromPixels(n.minus(r)).times(u),l=D.minus(S).minus(v).divide(u).plus(v);h.panTo(l,!0),h.applyConstraints()}else if(E.isPannable){var d=n.minus(r),f=h.deltaPointsFromPixels(d.negate(),!0);h.panTo(D.plus(f)),E.constrainDuringPan&&h.applyConstraints();var y=E.dragCursor;T&&!m&&y&&(m=!0,M.cursor=y)}}function a(t,e,n,i){if(i)if(--R,delete P[e],delete x[e],R){if(1===R){for(e in P)if(P.hasOwnProperty(e))break;x[e]=P[e],D=h.getCenter(),y=!0}}else E.useMomentum&&!y&&h.toss(),y=!1,h.applyConstraints();m&&(m=!1,M.cursor="")}function u(t,e,i){if(E.isZoomable){var o=Math.pow(E.zoomPerScroll,i);n(o,e)}}function c(){E.ignoreChange||E.redraw()}function S(t,e){return new SDPoint(SDMath_max(t-E.padding.right-E.padding.left,1),SDMath_max(e-E.padding.top-E.padding.bottom,1))}e=e||{};var h,l,D,d,f,m,g,p,w,v,y,_,E=this,x={},P={},M=document.documentElement.style,T=!window.opera,b=0,R=0;E.zoomPerClick=2,E.zoomPerScroll=Math.pow(2,1/3),E.zoomInToPoint=!0,E.zoomOutToPoint=!0,E.isPannable=!0,E.isZoomable=!0,E.constrainDuringPan=!1,E.ignoreChange=!1,E.useMomentum=!0,E.dragCursor="move",E.padding={top:0,right:0,bottom:0,left:0},SDObject_extend(E,e),function(){d=SDMath_max(t.clientWidth,1),f=SDMath_max(t.clientHeight,1);var n,i,o=new SDPoint(d,f),r=E.contentSize||o.times(1);if(!E.zoomContainers){if(window.SVGSVGElement&&t instanceof SVGSVGElement){var s=SDElement_getStyle(t);o=new SDPoint(parseFloat(s.width),parseFloat(s.height)),E.contentSize||(r=new SDPoint(t.viewBox.baseVal.width,t.viewBox.baseVal.height),0===r.x&&0===r.y&&(r=new SDPoint(t.width.baseVal.value,t.height.baseVal.value))),n=new SDSVGZoomContainer(t)}else window.HTMLCanvasElement&&t instanceof HTMLCanvasElement?(E.contentSize||(r=new SDPoint(t.width,t.height)),n=new SDCanvasZoomContainer(t)):n=new SDHTMLZoomContainer(t);E.zoomContainers=[n]}i=S(o.x,o.y),r.x*=i.x/o.x,r.y*=i.y/o.y,h=new SDViewport(i,r,e.viewportOptions),SDEventManager.call(E),t.style.msTouchAction="none"}(),l=new SDMouseTracker(t),l.addListener("click",o),l.addListener("press",r),l.addListener("drag",s),l.addListener("release",a),l.addListener("scroll",u),l.setTracking(!0),h.addListener("change",c),_=SDTimer.register(function(){if(b=(b+1)%30,0===b){var e=SDMath_max(t.clientWidth,1),n=SDMath_max(t.clientHeight,1);e===d&&n===f||(d=e,f=n,h.resize(S(e,n),!0),E.trigger("resize",e,n))}return!0}),E.getBounds=function(t){var e=h.getBounds(t),n=h.getContainerSize();return e.x-=e.width*E.padding.left/n.x,e.y-=e.height*E.padding.top/n.y,e.width*=1+(E.padding.left+E.padding.right)/n.x,e.height*=1+(E.padding.top+E.padding.bottom)/n.y,e},E.redraw=function(){
var t,e=E.getBounds(!0),n=h.getZoom(!0),i=E.zoomContainers;for(t=i.length-1;t>=0;t--)i[t].update(e,n)},E.dispose=function(t){if(SDTimer.unregister(_),!t){var e,n,i=E.zoomContainers,o=i.length;for(e=0;e<o;++e)n=i[e],n.dispose&&n.dispose()}},E.redraw(),E.viewport=h,E.tracker=l};